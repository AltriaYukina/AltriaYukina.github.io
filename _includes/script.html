<!--/* global-script-start */-->
<script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/mdui/0.2.1/js/mdui.min.js"></script>
<script src="https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>
<script>
    (function($){$.fn.scrollToTop=function(options){var config={"speed":800};if(options){$.extend(config,{"speed":options})}return this.each(function(){var $this=$(this);$(window).scroll(function(){if($(this).scrollTop()>100){$this.fadeIn()}else{$this.fadeOut()}});$this.click(function(e){e.preventDefault();$("body, html").animate({scrollTop:0},config.speed)})})};$.fn.scrollBodyToTop=function(options){var config={"speed":800};if(options){$.extend(config,{"speed":options})}return this.each(function(){var $this=$(this);$(".placeholder").scroll(function(){if($(this).scrollTop()>100){$this.fadeIn()}else{$this.fadeOut()}});$this.click(function(e){e.preventDefault();$(".placeholder").animate({scrollTop:0},config.speed)})})}})(jQuery);
</script>
<!--/* global-meng-script-start */-->
{% if site.data.site.uiux.meng == true %}
{% if site.data.meng.console.switch == true %}
{% if site.data.meng.console.theme_info == true %}
<script>
console.info("\n %c Â© Jekyll Theme MDUI |  Version: 0.4.5 | https://github.com/KeJunMao/jekyll-theme-mdui \n\n", "color: #fff; background: #448aff; padding:5px 0; border-radius: 5px 5px 5px 5px;");
</script>
{% endif %}
<script>
console.info("\n %c {{site.data.meng.console.text}} \n\n", "color: {{site.data.meng.console.color}}; background: {{site.data.meng.console.background}}; padding:5px 0; border-radius: 5px 5px 5px 5px;");
</script>
{% endif %}
{% if site.data.meng.title.switch == true %}
<script>
    var defaultTitle = document.title;
    {% if site.data.meng.title.with_default_title == true %}
    var hiddenText = '{{site.data.meng.title.hidden}}' +' '+ defaultTitle;
    var visibleText = '{{site.data.meng.title.visible}}' +' '+ defaultTitle;
    {% else %}
    var hiddenText = '{{site.data.meng.title.hidden}}';
    var visibleText = '{{site.data.meng.title.visible}}';
    {% endif %}
    var resetTime = {{site.data.meng.title.reset_time}};
    document.addEventListener("visibilitychange", function() {
	    if(document.visibilityState == "hidden" ){
            document.title = hiddenText;
        }
        if(document.visibilityState == "visible"){
            document.title = visibleText;
            setTimeout(function(){
                if(document.visibilityState == "visible"){
                    document.title = defaultTitle;
                }
            },resetTime);
        }
    }, false);
</script>
{% endif %}
{% endif %}
<!--/* global-meng-script-end */-->
<script type="text/javascript">
/* NProgress */
NProgress.configure({
    showSpinner: true
});
NProgress.start();
$('#nprogress .bar').css({
    'background': '{{site.data.site.uiux.nprogress_color}}'
});
$('#nprogress .peg').css({
    'box-shadow': '0 0 10px {{site.data.site.uiux.nprogress_color}}, 0 0 15px {{site.data.site.uiux.nprogress_color}}'
});
$('#nprogress .spinner-icon').css({
    'border-top-color': '{{site.data.site.uiux.nprogress_color}}',
    'border-left-color': '{{site.data.site.uiux.nprogress_color}}'
});
setTimeout(function() {
    NProgress.done();
},{{site.data.site.uiux.nprogress_buffer}});
/* Drag Out Menu */
var inst = new mdui.Drawer('#k-menu');
var drawer = document.getElementById('k-menu');
drawer.addEventListener('opened.mdui.drawer', function () {
    $('#k-menu').removeClass('mdui-drawer-open');
    $('#k-menu').css('transform','translateX(0)');
    $('.mdui-overlay').on('click',function(){
        $('#k-menu').css('transform',"");
    });
});
drawer.addEventListener('closed.mdui.drawer', function () {
     $("body").unbind("touchend");
     $("body").unbind("touchmove");
     $('#k-menu').css('transform',"");
});
$('body').on('touchstart',function(e){
    var touch = e.targetTouches[0];
    if (touch.pageX < 15){
        var touchstartX = touch.pageX;
        $('body').on('touchmove',function(e){
                if (e.targetTouches[0].pageX < 240-touchstartX){
                    var touch = e.targetTouches[0];
                    var x = touch.pageX - 240 + touchstartX;
                    $('#k-menu').css('transform',"translateX("+x+"px)");
                    $('body').on('touchend',function(){
                        if (x >= -120){
                            $('#k-menu').css('transform',"");
                            inst.open();
                        }
                        if (x < -120){
                            $('#k-menu').css('transform',"");
                            inst.close();
                        }
                    });
                }
        });
    }
});
/* serviceWorker */
$(function(){
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register("{{ "/sw.js" | relative_url }}").then(function() {
            console.log("Service Worker Registered");
        });
    }
    Array.prototype.forEach.call(document.querySelectorAll(".mdui-card-media"), function(a) {
        var b = a.querySelector("a");
        if (!b) {
            return
        }
        var c = b.getAttribute("href");
        if (!c) {
            return
        }
        a.addEventListener("click", function() {
            location.href = c
        })
    });
    $("#toTop").scrollToTop();
});
</script>
<!--/* global-script-end */-->
<!--/* home-script-start */-->
{% if page.layout =="home" %}
<script src="https://cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script>
<script>
$(function() {
    $(".k-post-media").lazyload({
        effect : "fadeIn"
    });
});
</script>
{% endif %}
<!--/* home-script-end */-->
<!--/* search-script-start */-->
{% for se in site.data.menus %}
{% if se.name == "navSearch" %}
{% if se.switch == true %}
{% if page.layout !='search' %}
<script src="{{ "/assets/js/jquery.typeahead.min.js" | prepend: site.baseurl }}"></script>
{% endif %}

<script>
    $('.k-navsearch-close').on('click',function(){
        $('.k-nav-search-card').hide();
    });
    $('.k-navsearch-open').on('click',function(){
        $('.k-nav-search-card').show();
    });
    $('#k-menu').on('click',function(e){
        $('.k-nav-search-card').hide();
    });
    $('#k-menu .mdui-textfield').on('click',function(e){
        e.stopPropagation();
        $('.k-nav-search-card').show();
    });
    $(window).scroll(function() {
        $('.k-navsearch-close').click();
    });
    var names = new Array();
    var urls = new Array(); 
    $.getJSON("{{ "/search.json" | relative_url }}").done(function(data){
            for (var index in data){
                var item = data[index];
                names[index] = item.title;
                urls[names[index]] = item.url
            }
            $.typeahead({
                input: '.k-nav-search',
                order: "desc",
                source: {
                    data: names
                },
               selector: {
                    container: "typeahead__container",
                    result: " mdui-card k-nav-search-card",
                    list: "mdui-list",
                    item: "mdui-list-item"
                },
                callback: {
                    onClick: function (node,a,item,event){
                        window.location.href = urls[item.display];
                    },
                }
            });
      });
</script>

{% endif %}
{% endif %}
{% endfor %}

{% if page.layout =='search' %}
<script src="{{ "/assets/js/jquery.typeahead.min.js" | prepend: site.baseurl }}"></script>
<script>
    var names = new Array();
    var urls = new Array(); 
    $.getJSON("{{ "/search.json" | relative_url }}").done(function(data){
            for (var index in data){
                var item = data[index];
                names[index] = item.title;
                urls[names[index]] = item.url
            }
            $.typeahead({
                input: '.js-typeahead-country_v1',
                order: "desc",
                source: {
                    data: names
                },
               selector: {
                    container: "typeahead__container",
                    result: " mdui-card k-search-card",
                    list: "mdui-list",
                    item: "mdui-list-item"
                },
                callback: {
                    onClick: function (node,a,item,event){
                        window.location.href = urls[item.display];
                    },
                }
            });
      });
</script>
{% endif %}
<!--/* search-script-end */-->
<!--/* post-script-start */-->
{% if page.layout == "post" or page.layout == "page"%}
{% if site.data.site.disqus.disqus_button == true  %}
<script>
/* Disqus */
var disqus = {
    load : function disqus(){
        var disqus_shortname = $("#load-disqus").attr("data");
        if(typeof DISQUS !== 'object') {
            (function () {
                var s = document.createElement('script'); s.async = true;
                s.type = 'text/javascript';
                s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
            }());
            $('#load-disqus').remove(); 
        }
    }
};
</script>
{% else %}
<script>
    function disqus(){
        var disqus_shortname = '{{ site.data.site.disqus.disqus_shortname }}';
        if(typeof DISQUS !== 'object') {
            (function () {
                var s = document.createElement('script'); s.async = true;
                s.type = 'text/javascript';
                s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
            }());
        }
    }
    disqus();
</script>
{% endif %}
{% endif %}

{% if page.layout == "post" %}
<script src="https://cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>
<script src="{{ "/assets/js/toc.min.js" | prepend: site.baseurl }}"></script>
<script src="{{ "/assets/js/pushpin.js" | prepend: site.baseurl }}"></script>
<!--/* post-meng-script-start */-->
{% if site.data.site.uiux.meng == true %}
{% if site.data.site.meng.header.switch == true%}
<script>
    const REG_HEX = /(^#?[0-9A-F]{6}$)|(^#?[0-9A-F]{3}$)/i;

/*
 * rgbå­ç¬¦ä¸²è§£æ
 * accepts: #333 #accded (without # is also fine)
 * not accept yet: rgb(), rgba()
 */
var rgbToHex = function(rgb) {
    var color = rgb.toString().match(/\d+/g);
    var hex = "#";
    for (var i = 0; i < 3; i++) {
        hex += ("0" + Number(color[i]).toString(16)).slice(-2);
    }
    return hex;
};
function parseRGB(str){
    if(typeof str === 'string' && REG_HEX.test(str) ){
        str = str.replace('#', '');
        let arr;
        if(str.length === 3){
            arr = str.split('').map(c => (c+c));
        }
        else if(str.length === 6){
            arr = str.match(/[a-zA-Z0-9]{2}/g);
        }
        else{
            throw new Error('wrong color format');
        }
        return arr.map((c) => parseInt(c, 16));
    }
    throw new Error('color should be string');
}

/*
 * rgb value to hsl è²ç¸(H)ãé¥±ååº¦(S)ãæåº¦(L)
 */
function rgbToHsl(rgbStr){
    let [r, g, b] = parseRGB(rgbStr);
    r /= 255, g /= 255, b /= 255;
    let max = Math.max(r, g, b), min = Math.min(r, g, b);
    let h, s, l = (max + min) / 2;

    if(max == min){
        h = s = 0; 
    }else{
        let d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch(max){
            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
            case g: h = (b - r) / d + 2; break;
            case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
    }
    return [h, s, l];
}

/*
 * å¤æ­é¢è²å±äºæ·±è²è¿æ¯æµè²
 */
function isColorDarkOrLight(rgbStr){
    var color = rgbToHex(rgbStr);
    let [h, s, l] = rgbToHsl(color);
    return (l > 0.5)? 'light' : 'dark';
}
var appVersion = navigator.appVersion;

if (appVersion.indexOf('Mobile') > 0){
    var isMobile = true;
}
if (isMobile){
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '{{ "/assets/js/rgbaster.min.js" | prepend: site.baseurl }}';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}
</script>
{% endif %}
{% endif %}
<!--/* post-meng-script-end */-->
<script>
$(function(){
    $('.mdui-card-content').find('a').attr('target','_blank');
    $("div.k-page-col").css('margin',0);
    hljs.initHighlightingOnLoad();
    $('#toc').toc({
        'selectors': 'h2',
        'prefix': 'toc',
        'highlightOffset': 64
    });
    $("#toc").find("ul").fadeIn(1000);
    var tocBottom = $('.mdui-card-content').offset().top + $('.mdui-card-content').height() - $('#toc-card').height();
    var tocOffset = $('.k-post-media').offset().top;
    var tocTop = $('.mdui-card-header').offset().top;
    $('#toc-card').pushpin({
      top: tocTop,
      bottom: 99999,
      offset: tocOffset
    });
    })
</script>
{% endif %}
<!--/* post-script-end */-->
<!--/* editor-script-start */-->
{% if page.layout =='editor' %}
<script src="{{ "/assets/js/pickerdata.js" | prepend: site.baseurl }}"></script>
<script src="{{ "/assets/js/chips.js" | prepend: site.baseurl }}"></script>
<script src="https://cdn.bootcss.com/simplemde/1.11.2/simplemde.min.js"></script>
<script>
$(function(){
    $('.datepicker').pickadate({
        selectMonths: true,
        selectYears: 15 
    });
    
    $('input:radio[name="group1"]').on("click",function(){
        var categories = $('input:radio[name="group1"]:checked').val();
        if (categories ==="radio_custom"){
            
        }
    });
     $('.chips').material_chip();
  $('.chips-initial').material_chip({
    data: [],
  });
  $('.chips-placeholder').material_chip({
    placeholder: 'Enter a tag',
    secondaryPlaceholder: '+Tag',
  });
  $("#imgurl").blur(function(){
      var text = $("#imgurl").val().toLowerCase();
    if (text.indexOf("jpg") >= 0 || text.indexOf("jpeg") >= 0 || text.indexOf("png") >= 0 || text.indexOf("gif") >= 0 || text.indexOf("svg") >= 0 || text.indexOf("webp") >= 0){
        $("#img").attr('src',$("#imgurl").val());
    }
  });
  var simplemde = new SimpleMDE({
      autosave: {
			enabled: true,
			unique_id: "newposts",
		}
  });
  function k_getDate(e,t){
    var date = new Date(e);
    var Y = date.getFullYear() + '-';
    var M = date.getMonth()+1 + '-';
    var D = date.getDate();
    if(t=== true){
        var h = date.getHours() + ':';
        var m = date.getMinutes() + ':';
        var s = date.getSeconds() + ' +0800';
        return Y+M+D+' '+h+m+s;
    }else{
        return Y+M+D;
    }
  };
  function k_getCategores(e){
      if (e.val() == "radio_custom"){
          return $("input[name='radio_custom']").val();
      }else{
          return e.val();
      }
  }
  function k_getTags(e){
      var tags = "";
    for (x in e){
        tags += e[x].tag+" ";
    }
    return tags;
  }
  function k_getFiletitle(e){
    var title = e.toLowerCase().split(" ");
    var newtitle = "";
    for (x in title){
        if (parseInt(x)+1 == title.length){
            newtitle += title[x];
        }else{
            newtitle += title[x]+"-";
        }
    }
    return newtitle;
  }
    var textFile = null,
        makeTextFile = function (text) {
            var data = new Blob([text], {
                type: 'text/plain'
            });
            if (textFile !== null) {
                window.URL.revokeObjectURL(textFile);
            }

            textFile = window.URL.createObjectURL(data);

            return textFile;
        };
    var create = document.getElementById('create');
    create.addEventListener('click', function () {
        var filename,filecontent,title,date,categories,tags,img;
        img = $('input[name=img]').val();
        tags = k_getTags($('.chips-initial').material_chip('data'));
        categories = k_getCategores($("input[name='group1']:checked"));
        date = k_getDate($('input[name=date]').val(),true);
        title = $('input[name=title]').val();
        filecontent = "---\nlayout: post\ntitle: "+title+"\ndate: "+date+"\ncategories: "+categories+"\ntags: "+tags+"\nimg: "+img+"\n---\n"+simplemde.value();
        title = k_getFiletitle(title);
        filename = k_getDate($('input[name=date]').val(),false)+'-'+title+'.markdown';
        $("#downloadlink").attr("download",filename);
        var link = document.getElementById('downloadlink');
        link.href = makeTextFile(filecontent);
        link.style.display = 'block';
    }, false);
    $("#downloadlink").click(function(){
        $(this).hide();
    })
});
</script>
{% endif %}
<!--/* editor-script-end */-->
<!--/* tags-script-start */-->
{% if page.layout == "tags" %}
<script>
$(function(){
function getUrlParam(name) {
    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
    var r = window.location.search.substr(1).match(reg);
    if (r != null) return unescape(r[2]); return null;
}
function getTagList(id){
    $.ajax({
        type: "GET",
        url:"{{ "/tags.json" | relative_url }}",
        dataType:"json",
        cache: true,
        success: function(data){
            var content = "<ul class='mdui-list'>";
            $.each(data,function(i,n){
                if(n.id === id){
                   var posts = n.post;
                   $.each(posts,function(i,n){
                       content+="<li class='mdui-list-item mdui-ripple'><a href='"+n.url+"'><div class='mdui-list-item-content'><div class='mdui-list-item-title mdui-list-item-one-line'>"+n.title+"</div><div class='mdui-list-item-text mdui-list-item-one-line'>"+n.excerpt+"</div></div></li>";
                   });
                }
            });
            content += "</ul>";
            $('#taglist').html(content)
        }
    })
}
var tagid;
var urltag = getUrlParam("tag");
if(urltag!=null){
        getTagList(urltag);
}
$(".k-tagcloud").on("click",function(e){
    var $this = $(this);
    tagid = $this.attr("id");
    if(tagid!=null){
        getTagList(tagid);
    }
});
})
</script>
{% endif %}
<!--/* tags-script-end */-->